{"version":3,"file":"index.js","sources":["../src/js/toast-styles.js","../src/js/refs.js","../src/js/render-functions.js","../src/js/pixabay-config.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["export const errorToastStyles = {\n  position: 'topRight',\n  timeout: 6000,\n  backgroundColor: '#ef4040',\n  titleColor: ' #fafafb',\n  messageColor: ' #fafafb',\n  iconUrl: new URL('../img/icon.svg', import.meta.url).href,\n};\n\nexport const warningToastStyles = {\n  position: 'topRight',\n  timeout: 5000,\n  backgroundColor: '#4e75ff',\n  titleColor: 'rgb(255, 255, 255',\n  messageColor: 'rgb(255, 255, 255)',\n};\n","export default {\n  searchForm: document.querySelector('.js-form'),\n  galleryList: document.querySelector('.js-gallery'),\n  loader: document.querySelector('.loader'),\n  loadMoreBtn: document.querySelector('.next-page-btn'),\n};\n","export const createGalleryCardTemplate = images => {\n  return images\n    .map(\n      imgInfo => `<li class=\"gallery-item\">\n        <a class = 'large-img' href=\"${imgInfo.largeImageURL}\">\n          <img src=\"${imgInfo.webformatURL}\" alt=\"${filterDublicateValues(\n        imgInfo.tags\n      )}\" loading=\"lazy\" />\n        </a>\n        <div class=\"post-stats\">\n         <div class=\"stats-unit\">\n          <p class=\"stat-header\">Likes</p>\n          <p class =\"stat-amount\">${imgInfo.likes}</p>\n         </div>\n          <div class=\"stats-unit\">\n          <p class=\"stat-header\">Views</p>\n          <p class =\"stat-amount\">${imgInfo.views}</p>\n         </div>\n            <div class=\"stats-unit\">\n          <p class=\"stat-header\">Comments</p>\n           <p class =\"stat-amount\">${imgInfo.comments}</p>\n         </div>\n          <div class=\"stats-unit\">\n          <p class=\"stat-header\">Downloads</p>\n           <p class =\"stat-amount\">${imgInfo.downloads}</p>\n         </div>\n        </div>\n      </li>`\n    )\n    .join('');\n};\n\nfunction filterDublicateValues(text) {\n  return text\n    .split(', ')\n    .filter((el, ind, arr) => arr.indexOf(el) === ind)\n    .join(', ');\n}\n","export const API_KEY = '48449909-94b1753e13b470dade065bce0';\nexport const BASE_URL = 'https://pixabay.com/api/';\n\nexport const config = {\n  key: API_KEY,\n  image_type: 'photo',\n  orientation: 'horizontal',\n  safesearch: 'true',\n  page: 1,\n  per_page: 15,\n};\n","import axios from 'axios';\nimport { config, BASE_URL } from './pixabay-config';\n\nexport const fetchPicsByQuery = (searchedQuery, currentPage = 1) => {\n  const searchParams = new URLSearchParams({\n    ...config,\n    q: searchedQuery,\n    page: currentPage,\n  });\n\n  return axios.get(`${BASE_URL}?${searchParams}`);\n};\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport { errorToastStyles, warningToastStyles } from './js/toast-styles';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport domRefs from './js/refs.js';\nimport { createGalleryCardTemplate } from './js/render-functions';\nimport { fetchPicsByQuery } from './js/pixabay-api.js';\n\nconst searchState = {\n  query: '',\n  currentPage: 1,\n};\n\nconst simpleLightboxInstance = new SimpleLightbox('.js-gallery a', {\n  captionsData: 'alt',\n  captionsDelay: 250,\n});\n\nconst toggleLoader = isLoading => {\n  domRefs.loader.style.display = isLoading ? 'block' : 'none';\n};\n\nconst onSearchFormSubmit = async event => {\n  try {\n    event.preventDefault();\n\n    searchState.query = event.currentTarget.elements.name_query.value.trim();\n\n    if (searchState.query === '') {\n      iziToast.warning({\n        ...warningToastStyles,\n        title: 'Warning',\n        message: 'Empty field , please insert your query...',\n      });\n      return;\n    }\n\n    toggleLoader(true);\n    domRefs.galleryList.innerHTML = '';\n    domRefs.loadMoreBtn.classList.add('is-hidden');\n    searchState.currentPage = 1;\n\n    const { data } = await fetchPicsByQuery(searchState.query, searchState.currentPage);\n    toggleLoader(false);\n\n    if (data.hits.length === 0 || data.totalHits === 0) {\n      iziToast.error({\n        ...errorToastStyles,\n        title: '',\n        message: 'Sorry, there are no images matching your search query. Please try again!',\n      });\n\n      domRefs.searchForm.reset();\n      return;\n    }\n\n    domRefs.galleryList.innerHTML = createGalleryCardTemplate(data.hits);\n    simpleLightboxInstance.refresh();\n\n    const totalPages = Math.ceil(data.totalHits / 15);\n\n    if (totalPages > 1 && data.hits.length === 15) {\n      domRefs.loadMoreBtn.classList.remove('is-hidden');\n    }\n  } catch (err) {\n    console.log(err);\n    iziToast.error({\n      ...errorToastStyles,\n      title: 'Error',\n      message: 'Something went wrong... Please try again later.',\n    });\n  }\n};\n\nconst onLoadMoreClick = async () => {\n  searchState.currentPage += 1;\n\n  toggleLoader(true);\n  domRefs.loadMoreBtn.classList.add('is-hidden');\n\n  try {\n    const {\n      data: { hits, totalHits },\n    } = await fetchPicsByQuery(searchState.query, searchState.currentPage);\n\n    const markup = createGalleryCardTemplate(hits);\n    domRefs.galleryList.insertAdjacentHTML('beforeend', markup);\n    simpleLightboxInstance.refresh();\n\n    toggleLoader(false);\n    domRefs.loadMoreBtn.classList.remove('is-hidden');\n\n    const totalPages = Math.ceil(totalHits / 15);\n\n    const firstCard = document.querySelector('.gallery-item');\n    if (firstCard) {\n      const cardHeight = firstCard.getBoundingClientRect().height;\n      setTimeout(() => {\n        window.scrollBy({\n          top: cardHeight * 2,\n          behavior: 'smooth',\n        });\n      }, 200);\n    } else {\n      iziToast.error({\n        ...errorToastStyles,\n        title: 'Error',\n        message: 'Something went wrong... Please try again later.',\n      });\n    }\n\n    if (hits.length < 15 || searchState.currentPage >= totalPages) {\n      domRefs.loadMoreBtn.classList.add('is-hidden');\n      iziToast.warning({\n        ...warningToastStyles,\n        title: 'Warning',\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n    }\n  } catch (err) {\n    console.error(err);\n    toggleLoader(false);\n    iziToast.error({\n      ...errorToastStyles,\n      title: 'Error',\n      message: 'Failed to load more images. Please try again later.',\n    });\n  }\n};\n\ndomRefs.searchForm.addEventListener('submit', onSearchFormSubmit);\n\ndomRefs.loadMoreBtn.addEventListener('click', onLoadMoreClick);\n"],"names":["errorToastStyles","warningToastStyles","domRefs","createGalleryCardTemplate","images","imgInfo","filterDublicateValues","text","el","ind","arr","API_KEY","BASE_URL","config","fetchPicsByQuery","searchedQuery","currentPage","searchParams","axios","searchState","simpleLightboxInstance","SimpleLightbox","toggleLoader","isLoading","onSearchFormSubmit","event","iziToast","data","err","onLoadMoreClick","hits","totalHits","markup","totalPages","firstCard","cardHeight"],"mappings":"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"}